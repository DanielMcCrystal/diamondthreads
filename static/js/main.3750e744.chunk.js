(this["webpackJsonpdiamond-threads"]=this["webpackJsonpdiamond-threads"]||[]).push([[0],{102:function(e,t){},111:function(e,t){},118:function(e,t){},124:function(e,t){},126:function(e,t){},134:function(e,t){},206:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),i=a(79),r=a.n(i),o=(a(93),a(18)),l=a(14),c=a(29),h=a(28),u=a(210),d=a(211),f=(a(94),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).messageData=void 0,s.myMessageRef=void 0,s.myMessageBoxContainerRef=void 0,s.lastCommentRef=void 0,s.state={myMessageBoxContainerHeight:0,collapseOffset:0},s.collapseOffsetFromChild=0,s.messageData=e.dataManager.getMessageData(e.messageId),s.myMessageRef=n.a.createRef(),s.myMessageBoxContainerRef=n.a.createRef(),s.lastCommentRef=n.a.createRef(),s}return Object(l.a)(a,[{key:"setCollapseOffset",value:function(e){this.collapseOffsetFromChild=e}}]),Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.myMessageRef,t=this.myMessageBoxContainerRef;if(e.current&&t.current){var a=e.current.offsetHeight+this.collapseOffsetFromChild,s=a-t.current.offsetHeight;this.props.parentMessage&&this.props.parentMessage.setCollapseOffset(s),this.setState({collapseHeight:a,collapseOffset:this.collapseOffsetFromChild,myMessageBoxContainerHeight:t.current.offsetHeight})}}},{key:"getReplyComponents",value:function(){var e=this,t=this.messageData.replies,s=t.length-1;return t.slice(0,s).map((function(t){return n.a.createElement(a,{key:t,messageId:t,dataManager:e.props.dataManager,offsetHeight:e.props.offsetHeight+e.state.myMessageBoxContainerHeight})}))}},{key:"getLastReplyComponent",value:function(e){var t=this.messageData.replies;if(0===t.length)return null;var s=t[t.length-1];return n.a.createElement("div",{className:"lastReply",style:{display:"flex"}},n.a.createElement("div",{style:{width:50,minWidth:50,backgroundColor:e}}),n.a.createElement(a,{ref:this.lastCommentRef,key:s,messageId:s,parentMessage:this,dataManager:this.props.dataManager,offsetHeight:this.props.offsetHeight+this.state.myMessageBoxContainerHeight}))}},{key:"render",value:function(){var e="hsl(0, 0%, ".concat(85-this.messageData.depth%2*10,"%)");return n.a.createElement("div",{className:"messageContainer",style:{zIndex:this.messageData.depth,marginBottom:1===this.messageData.depth?10:0}},n.a.createElement("div",{className:"message",ref:this.myMessageRef,style:{backgroundColor:e,paddingRight:5,height:this.state.collapseHeight?this.state.collapseHeight:"auto",marginBottom:"".concat(-this.state.collapseOffset,"px")}},n.a.createElement("div",{className:"messageBoxContainer",ref:this.myMessageBoxContainerRef,style:{position:"sticky",top:this.props.offsetHeight,backgroundColor:e,zIndex:2*this.props.dataManager.getMaxDepth()-this.messageData.depth+1}},n.a.createElement("div",{style:{padding:10}},n.a.createElement("div",{className:"messageBox"},n.a.createElement("div",{className:"commentMetadata"},n.a.createElement("b",null,this.messageData.author)),this.messageData.text))),this.messageData.replies.length>0?n.a.createElement("div",{className:"repliesContainer"},n.a.createElement("div",{style:{width:50,minWidth:50}}),n.a.createElement("div",{className:"replies"},this.getReplyComponents())):null),this.getLastReplyComponent(e))}}]),a}(n.a.Component)),g=a(53),m=a.n(g),p=a(80),y=a(96),v=function(){function e(t){Object(o.a)(this,e),this.sr=void 0,this.dataManager=void 0,this.sr=new y({clientId:"4hLFsXj1w7VJ5Q",clientSecret:"fcn8ceF26gEvGFJpCTuuAM0MbAE",refreshToken:"12080383-eFbYr4gUAfbeeNx_PIDu8CtBGXI"}),this.dataManager=t}return Object(l.a)(e,[{key:"populateComments",value:function(e){var t=this;e.comments.forEach((function(e){t.postRootComment(e)}))}},{key:"postRootComment",value:function(e){var t=this,a=this.dataManager.addRootMessage(e.author.name,e.body,e.id);e.replies.forEach((function(e){t.postReply(e,a)}))}},{key:"postReply",value:function(e,t){var a=this,s=this.dataManager.addReply(e.author.name,e.body,t,e.id);e.replies.forEach((function(e){a.postReply(e,s)}))}},{key:"fetchPost",value:function(){var e=Object(p.a)(m.a.mark((function e(t,a){var s=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sr.getSubmission(t).fetch().then((function(e){s.populateComments(e),a()})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),M=function(){function e(){Object(o.a)(this,e),this.currentMessageId=0,this.rootMessages=new Set,this.allMessages={},this.maxDepth=0,this.ready=!1}return Object(l.a)(e,[{key:"getMaxDepth",value:function(){return this.maxDepth}},{key:"getMessageData",value:function(e){return this.allMessages[e]}},{key:"getRootMessageIds",value:function(){return Array.from(this.rootMessages)}},{key:"createNewMessage",value:function(e,t,a,s){s||(s=this.currentMessageId.toString(),this.currentMessageId+=1);var n=1;null!==a&&void 0!==a&&((n=this.getMessageData(a).depth+1)>this.maxDepth&&(this.maxDepth=n));return{id:s,text:t,author:e,replyTo:a,replies:[],depth:n}}},{key:"addRootMessage",value:function(e,t,a){var s=this.createNewMessage(e,t,null,a);return this.rootMessages.add(s.id),this.allMessages[s.id]=s,s.id}},{key:"addReply",value:function(e,t,a,s){var n=this.createNewMessage(e,t,a,s);return this.allMessages[n.id]=n,this.allMessages[a].replies.push(n.id),n.id}},{key:"markReady",value:function(){this.ready=!0}},{key:"isReady",value:function(){return this.ready}}]),e}(),R=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).dataManager=void 0,s.redditManager=void 0,s.scrollRef=void 0,s.dataManager=new M,s.redditManager=new v(s.dataManager),s.scrollRef=n.a.createRef(),s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.redditManager.fetchPost(this.props.submissionId,(function(){e.dataManager.markReady(),e.forceUpdate()}))}},{key:"getMessageComponents",value:function(){var e=this;return this.dataManager.getRootMessageIds().map((function(t){return n.a.createElement(f,{key:t,offsetHeight:0,messageId:t,dataManager:e.dataManager})}))}},{key:"render",value:function(){return n.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"90%"}},this.dataManager.isReady()?this.getMessageComponents():null)}}]),a}(n.a.Component),C=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={lastSubmissionId:null},e.enteredURL="",e}return Object(l.a)(a,[{key:"submitURL",value:function(){var e=this.enteredURL.indexOf("/comments/");if(-1!==e){var t=this.enteredURL.substr(e+10,6);this.setState({lastSubmissionId:t})}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},n.a.createElement("div",{style:{alignSelf:"stretch",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement(u.a,{placeholder:"Enter a reddit URL",width:800,height:60,onChange:function(t){e.enteredURL=t.target.value},style:{marginRight:20}}),n.a.createElement(d.a,{appearance:"primary",height:56,onClick:function(){e.submitURL()}},"Go"))),this.state.lastSubmissionId?n.a.createElement(R,{submissionId:this.state.lastSubmissionId}):null)}}]),a}(n.a.Component);var b=function(){return n.a.createElement(C,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},59:function(e,t){},64:function(e,t){},88:function(e,t,a){e.exports=a(206)},93:function(e,t,a){},94:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.3750e744.chunk.js.map